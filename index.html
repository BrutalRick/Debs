<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Client Questionnaire</title>
    <style>
            body {
              font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
              margin: 0;
              padding: 0;
              background-color: #f1efef;
              color: #333;
            }

            .container {
              width: 45%;
              margin: auto;
              overflow: hidden;
            }

            #part-one,
            #part-two,
            #part-three,
            #engagement-letter {
              background: #fff;
              margin: 50px 0;
              padding: 20px;
              border-radius: 10px;
              box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
              display: none;
            }

            #part-one.active,
            #part-two.active,
            #part-three.active,
            #engagement-letter.active {
              display: block;
            }

            .form-group label {
              font-weight: bold;
              margin-bottom: 8px;
            }

            .form-group input,
            .form-group select {
              box-sizing: border-box;
              width: 100%;
              padding: 8px;
              margin-bottom: 10px;
              border-radius: 4px;
              border: 1px solid #ccc;
            }


      }

            #part-one.active,
            #part-two.active,
            #part-three.active {
              display: block;
            }

            .part_h{color: #071441; /* 设置文本颜色为深蓝色 */
        text-align: center; /* 将文本居中 */
        padding: 15px;}

        .EL_h {text-align: center;
          padding: 15px;}


            .form-group {
              margin-bottom: 15px;
            }

            .form-group label {
              display: block;
              margin-bottom: 5px;
            }

            .form-group input {
              width: 100%;
              padding: 10px;
              border: 1px solid #ccc;
              border-radius: 4px;
            }

            .btn {
              display: inline-block;
              color: #fff;
              background-color: #071441;
              border: none;
              padding: 10px 20px;
              font-size: 16px;
              cursor: pointer;
              border-radius: 4px;

            }

            .btn:hover {
              background-color: #004494;
            }

            .add-more:hover,
            .remove-last:hover {
              background-color: #1b6caa;
            }




            .boxes {
              display: block;
              margin-bottom: 10px; /* Optional: for some space between the labels */
            }

            .form-page {
              display: none;
            }

            .form-page.active {
              display: block;
            }

            .blockchain-group {
              margin-bottom: 15px;
            }
            .add-more {
              margin-top: 10px;
            }

            .button-group {
              margin-top: 10px;
            }

            .input-field {
              width: 100%; /* Or set a fixed width like 300px */
              max-width: 500px; /* This will ensure the input fields do not stretch beyond 500px */
              box-sizing: border-box; /* This ensures padding and border are included in the element's total width and height */
            }

            .required-star {
              color: red;
            }

            .logo-container {
        display: flex;
        justify-content: center; /* Center horizontally */
        align-items: center; /* Center vertically */
        background-color: #fff;
        padding: 10px 0;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }


            .logo {
              width: 250px;
            }

            .letter-content h1,
            .letter-content h2 {
              color: #0056b3;
            }
    </style>
  </head>
  <body>
    <div class="logo-container">
      <img src="TNF-Logo_Color.png" alt="TNF Logo" class="logo" />
    </div>

    <div class="container">
      <div id="part-one" class="active">
        <h2 class="part_h">Part One - General Information</h2>
        <form>
          <div class="form-group">
            <label for="prefix"
              >Prefix <span class="required-star">*</span></label
            >
            <select id="prefix" name="prefix" required>
              <option value="">Please select</option>
              <option value="mr">Mr.</option>
              <option value="ms">Ms.</option>
              <option value="mrs">Mrs.</option>
              <option value="miss">Miss</option>
              <option value="dr">Dr.</option>
              <!-- 添加其他需要的选项 -->
            </select>
          </div>
          <!-- This is a hidden input to store the prefix value -->
          <input type="hidden" id="hidden-prefix" name="hidden-prefix" />

          <div class="form-group">
            <label for="first-name"
              >First Name <span class="required-star">*</span></label
            >
            <input type="text" id="first-name" name="first-name" required />
          </div>
          <div class="form-group">
            <label for="last-name"
              >Last Name <span class="required-star">*</span></label
            >
            <input type="text" id="last-name" name="last-name" required />
          </div>
          <div class="form-group">
            <label for="address"
              >Address <span class="required-star">*</span></label
            >
            <input type="text" id="address" name="address" required />
          </div>
          <div class="form-group">
            <label for="phone-number"
              >Phone Number <span class="required-star">*</span></label
            >
            <input type="text" id="phone-number" name="phone-number" required />
          </div>
          <div class="form-group">
            <label for="email"
              >Email <span class="required-star">*</span></label
            >
            <input type="email" id="email" name="email" required />
          </div>
          <button type="button" class="btn" onclick="showPartTwo()">
            Next
          </button>
        </form>
      </div>

      <div id="part-two">
        <div class="back-arrow" onclick="showPartOne()">← Back</div>
        <h2 class="part_h">Part Two - Cryptocurrency Activity</h2>
        <form>
          <h3>Capital Gains Related Activity</h3>
          <label class="boxes">
            <input type="checkbox" id="cex-sale" name="cex-sale" />
            <span class="checkmark"></span>
            Sale of cryptocurrencies utilizing centralized exchange/s (CEX)
          </label>
          <label class="boxes">
            <input type="checkbox" id="dex-sale" name="dex-sale" />
            <span class="checkmark"></span>
            Sale of cryptocurrencies utilizing decentralized exchange/s (DEX)
            protocols
          </label>
          <label class="boxes">
            <input type="checkbox" id="p2p-sale" name="p2p-sale" />
            <span class="checkmark"></span>
            Sale of cryptocurrencies in a peer-to-peer manner/OTC (from a
            friend, etc.)
          </label>
          <label class="boxes">
            <input type="checkbox" id="defi-liquidity" name="defi-liquidity" />
            <span class="checkmark"></span>
            DeFi Liquidity Pools withdrawals & activity to Automated Market
            Maker (AMM) protocols
          </label>
          <label class="boxes">
            <input type="checkbox" id="selling-nfts" name="selling-nfts" />
            <span class="checkmark"></span>
            Selling NFTs through centralized marketplaces or decentralized
            marketplaces
          </label>
          <label class="boxes">
            <input
              type="checkbox"
              id="wrapping-crypto"
              name="wrapping-crypto"
            />
            <span class="checkmark"></span>
            Wrapping and unwrapping crypto
          </label>

          <h3>Incoming Related Activity</h3>
          <label class="boxes">
            <input
              type="checkbox"
              id="airdropped-assets"
              name="airdropped-assets"
            />
            <span class="checkmark"></span>
            Airdropped assets (standard, bounty, exclusive, holder)
          </label>
          <label class="boxes">
            <input
              type="checkbox"
              id="receiving-crypto"
              name="receiving-crypto"
            />
            <span class="checkmark"></span>
            Receiving crypto in compensation for the performance of services
          </label>
          <label class="boxes">
            <input
              type="checkbox"
              id="staking-activities"
              name="staking-activities"
            />
            <span class="checkmark"></span>
            Staking activities & Interest (Crypto, NFTs, etc.)
          </label>
          <label class="boxes">
            <input
              type="checkbox"
              id="farming-activities"
              name="farming-activities"
            />
            <span class="checkmark"></span>
            Farming activities
          </label>
          <label class="boxes">
            <input
              type="checkbox"
              id="creating-collecting"
              name="creating-collecting"
            />
            <span class="checkmark"></span>
            Creating and collecting crypto - NFTs for sale
          </label>

          <h3>Other Related Activity</h3>
          <label class="boxes">
            <input type="checkbox" id="dao-activities" name="dao-activities" />
            <span class="checkmark"></span>
            DAO activities with governance tokens (voting and/or compensation)
          </label>
          <label class="boxes">
            <input type="checkbox" id="gifting-crypto" name="gifting-crypto" />
            <span class="checkmark"></span>
            Gifting crypto to others for charitable purposes
          </label>
          <label class="boxes">
            <input type="checkbox" id="receipt-value" name="receipt-value" />
            <span class="checkmark"></span>
            Receipt of value from SAFT/SAFE agreements
          </label>
          <label class="boxes">
            <input type="checkbox" id="minting-nfts" name="minting-nfts" />
            <span class="checkmark"></span>
            Minting of NFTs
          </label>
          <label class="boxes">
            <input type="checkbox" id="burning-nfts" name="burning-nfts" />
            <span class="checkmark"></span>
            Burning NFTs (mint passes, burn to stake, etc.)
          </label>
          <label class="boxes">
            <input
              type="checkbox"
              id="international-activities"
              name="international-activities"
            />
            <span class="checkmark"></span>
            International activities such as Puerto Rico residents
          </label>
          <label class="boxes">
            <input
              type="checkbox"
              id="lost-stolen-hacked"
              name="lost-stolen-hacked"
            />
            <span class="checkmark"></span>
            Lost, stolen, hacked crypto/NFTs
          </label>

          <label class="boxes">
            <input
              type="checkbox"
              id="validate-kd-peter"
              name="validate-kd-peter"
            />
            <span class="checkmark"></span>
            Validate with KD & Peter, no loss deduction anywhere
          </label>

          <button type="button" class="btn" onclick="showPartThree()">
            Next
          </button>
        </form>
      </div>

      <div id="part-three" class="form-page">
        <div class="back-arrow" onclick="showPartTwo()">← Back</div>
        <h2 class="part_h">Part Three - Wallet Addresses</h2>
        <form id="blockchain-form">
          <div class="blockchain-group" id="blockchain-group-1">
            <label for="blockchain-1">Blockchain:</label>
            <select id="blockchain-1" name="blockchain-1">
              <option value="Bitcoin">Bitcoin</option>
              <option value="Ethereum">Ethereum</option>
              <option value="Algorand">Algorand</option>
              <option value="Litecoin">Litecoin</option>
              <option value="Dogecoin">Dogecoin</option>
              <option value="Cardano">Cardano</option>
              <option value="Polkadot">Polkadot</option>
              <option value="Solana">Solana</option>
              <option value="Ripple">Ripple</option>
              <!-- ... other blockchains ... -->
            </select>
            <label for="address-count-1">Number of Wallet Addresses:</label>
            <input
              type="number"
              id="address-count-1"
              name="address-count-1"
              value="0"
              required
            />
          </div>
          <button type="button" class="btn add-more" onclick="addMore()">
            +
          </button>
          <button type="button" class="btn remove-last" onclick="removeLast()">
            -
          </button>

          <div class="button-group">
            <button type="button" class="btn" onclick="showEngagementLetter()">
              Submit
            </button>
          </div>
        </form>
      </div>

      <div id="engagement-letter" class="form-page">
        <div class="back-arrow" onclick="showPartThree()">← Back</div>
        <div class="letter-content">
          <h1 class="EL_h">Engagement Letter</h1>
          <p>Dear <span id="client-name"></span>,</p>
          <p>
            The Network Firm LLP (“TNF,” “we” or “us”) is pleased to provide the
            services described below (collectively, the “Services”) to the
            above-named Client (“Client” or “you”). The Services are subject to
            the terms and conditions of this engagement letter and the Terms &
            Conditions for Professional Services, located at
            <a href="https://www.thenetworkfirm.com/terms-of-use"
              >https://www.thenetworkfirm.com/terms-of-use</a
            >
            (together, this “Agreement”).
          </p>
          <h2>SCOPE OF WORK</h2>
          <ul id="services-list">
            <!-- List of services will be generated here based on user input -->
          </ul>
          <ul id="wallets-list">
            <!-- List of blockchain and wallet addresses will be generated here based on user input -->
          </ul>
          <p>
            At your direction, we will perform crypto and digital assets basis
            tracking, reconciliation, and reporting services on an advisory
            basis. (“Basis Tracking Services”). At the conclusion of our
            engagement, we will provide you with a detailed memo outlining the
            actions taken and results of our procedures. This Agreement does not
            include services for a Tax Opinion. A more detailed description of
            the Services is provided in Exhibit A.
          </p>
          <h2>PRICING</h2>
          <p>
            Our price for the Services will be a one-time payment of
            <span id="totalQuote"></span>. All payments for services will be due
            in advance, invoiced to you and due at the time of receipt. Pricing
            estimates for basis tracking and reconciliation support are based on
            the agreed wallet and transactions scope in Exhibit A. Pricing
            estimates anticipate that we do not encounter any unexpected
            circumstances, such as additional tasks and work effort, addition of
            wallets and transaction volume, and delayed responses by you to our
            requests for information or documents. For example, if our work is
            delayed because you do not complete requested schedules or provide
            other information as requested, we will need to spend additional
            time that will be billed to you at our standard hourly rates or
            incur additional expenses that will be billed to you separately. The
            price estimate above does not include the price for general tax
            advisory and/or compliance filing services. The price for general
            tax advisory and/or compliance filing services, performed from time
            to time at your request, will be based on our standard hourly rates.
            Any additional professional services not specifically described in
            the scope of service or Exhibit A, or any additional time and effort
            we may spend as a result of the changes in tax legislation that may
            impact our Services to you, will be billed separately using our
            standard hourly rates and made known to you in advance.
          </p>

          <h2>RESPONSIBILITIES</h2>
          <p>
            Work is to be conducted remotely from TNF offices or other off-site
            locations. TNF will act as a consultant but will not serve as your
            “authorized representative” or “Agent” for any interactions or
            communications with your vendors, Internal Revenue Service, or other
            third parties. TNF is not responsible for, and will not verify, the
            information you provide under this Agreement. We will assume all
            information provided by you is accurate and will not be responsible
            for any material misstatements. In order to deliver digital assets
            basis tracking, reconciliation, and reporting services completely
            and accurately to you, you are responsible to provide us with
            complete wallet and exchange account information in a timely manner.
            A successful working relationship requires a significant commitment
            on our part, as well as yours. You are responsible to be available
            during our ongoing work with you, provide timely responses to
            questions and calls for decisions, and devote the resources
            necessary to achieve the objectives of the engagement. If the
            information you provide is not submitted in a timely manner or is
            incomplete or unusable, we reserve the right to charge additional
            expenses for services. If this occurs, we will contact you to
            discuss the matter and the anticipated delay in performing our
            Services. You understand and acknowledge that we will not provide
            you with any investment or legal advice in connection with the
            Services. Additionally, we will not provide tax advice unless we are
            specifically engaged to do so under a separate agreement.
          </p>

          <h2>CONCLUSION</h2>
          <p>
            We appreciate the opportunity to be of service to you and believe
            this Agreement accurately summarizes the terms applicable to the
            Services. If you have any questions, please let us know. If you
            agree with the terms of this Agreement, please sign and return it to
            us.
          </p>
          <p>Sincerely,</p>
          <p>Noah Buxton</p>
          <p>CEO & Co-founder</p>
          <p>The Network Firm LLP</p>

          <p>
            THIS AGREEMENT, INCLUDING THE TERMS & CONDITIONS FOR PROFESSIONAL
            SERVICES AVAILABLE AT
            <a
              href="https://www.thenetworkfirm.com/terms-and-conditions-for-professional-service"
              >https://www.thenetworkfirm.com/terms-and-conditions-for-professional-service</a
            >
            IS HEREBY APPROVED AND ACCEPTED:
          </p>
        </div>
        <form id="signature-form">
          <div class="form-group">
            <label for="signature-name"
              >Signature <span class="required-star">*</span></label
            >
            <input
              type="text"
              id="signature-name"
              name="signature-name"
              class="input-field"
              required
            />
          </div>
          <div class="form-group">
            <label for="signature-date"
              >Date <span class="required-star">*</span></label
            >
            <input
              type="date"
              id="signature-date"
              name="signature-date"
              class="input-field"
              required
            />
          </div>

          <button type="button" class="btn" onclick="submitSignature()">
            Submit
          </button>
        </form>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"></script>
    <script>
      function showPartOne() {
        document.getElementById("part-two").classList.remove("active");
        document.getElementById("part-one").classList.add("active");
      }

      function showPartTwo() {
        var form = document.querySelector("#part-one form");

        // Check if the form is valid
        if (form.checkValidity()) {
          // Store the selected prefix value
          var prefix = document.getElementById("prefix").value;
          document.getElementById("hidden-prefix").value = prefix;

          // Continue with existing code...
          document.getElementById("part-one").classList.remove("active");
          document.getElementById("part-three").classList.remove("active");
          document.getElementById("part-two").classList.add("active");
        } else {
          // If the form is invalid, display an error message
          alert("Please fill out all required fields.");
        }
      }

      function showPartThree() {
        document.getElementById("engagement-letter").classList.remove("active");
        document.getElementById("part-two").classList.remove("active");
        document.getElementById("part-three").classList.add("active");
      }

      var blockchainCounter = 1;

      function addMore() {
        blockchainCounter++;
        var newGroup = document.createElement("div");
        newGroup.className = "blockchain-group";
        newGroup.id = "blockchain-group-" + blockchainCounter;
        newGroup.innerHTML = `
        <label for="blockchain-${blockchainCounter}">Blockchain:</label>
        <select id="blockchain-${blockchainCounter}" name="blockchain-${blockchainCounter}">
          <option value="Bitcoin">Bitcoin</option>
          <option value="Ethereum">Ethereum</option>
          <option value="Algorand">Algorand</option>
          <option value="Litecoin">Litecoin</option>
          <option value="Dogecoin">Dogecoin</option>
          <option value="Cardano">Cardano</option>
          <option value="Polkadot">Polkadot</option>
          <option value="Solana">Solana</option>
          <option value="Ripple">Ripple</option>
        </select>
        <label for="address-count-${blockchainCounter}">Number of Wallet Addresses:</label>
        <input type="number" id="address-count-${blockchainCounter}" name="address-count-${blockchainCounter}" value="0" required>
    `;
        var form = document.getElementById("blockchain-form");
        form.insertBefore(newGroup, form.querySelector(".add-more"));
      }

      function removeLast() {
        var form = document.getElementById("blockchain-form");
        var groups = form.querySelectorAll(".blockchain-group");
        var lastGroup = groups[groups.length - 1];
        if (lastGroup && lastGroup.id !== "blockchain-group-1") {
          // prevent removal of the first group
          form.removeChild(lastGroup);
          blockchainCounter--; // decrement the counter since we've removed a group
        }
      }

      function showEngagementLetter() {
        // Hide the current form
        document.getElementById("part-three").classList.remove("active");

        // Show the engagement letter
        var engagementLetter = document.getElementById("engagement-letter");
        engagementLetter.classList.add("active");

        // Generate the letter content based on user input
        generateLetter();
      }

      function generateLetter() {
        // Retrieve the prefix and the names
        var prefix = document.getElementById("hidden-prefix").value;
        var firstName = document.getElementById("first-name").value;
        var lastName = document.getElementById("last-name").value;

        // Check the prefix and format accordingly
        var formattedPrefix;
        if (prefix.toLowerCase() === "miss") {
          formattedPrefix = "Miss"; // 'Miss' does not have a period
        } else {
          // Capitalize the first letter and add a period for other prefixes
          formattedPrefix =
            prefix.charAt(0).toUpperCase() +
            prefix.slice(1).toLowerCase() +
            ".";
        }

        // Set the client's name including the formatted prefix
        var clientName = `${formattedPrefix} ${lastName}`;
        document.getElementById("client-name").textContent = clientName;

        // Reset engagement letter to default state
        var servicesList = document.getElementById("services-list");
        var walletsList = document.getElementById("wallets-list");
        var quoteParagraph = document.getElementById("quote-paragraph"); // Get the old quote paragraph

        // Remove all child nodes of services-list
        while (servicesList.firstChild) {
          servicesList.removeChild(servicesList.firstChild);
        }

        // Remove all child nodes of wallets-list
        while (walletsList.firstChild) {
          walletsList.removeChild(walletsList.firstChild);
        }

        // Remove old quote paragraph if it exists
        if (quoteParagraph) {
          quoteParagraph.parentNode.removeChild(quoteParagraph);
        }

        // Capture Part Two Information
        var servicesList = document.getElementById("services-list");
        var checkboxes = document.querySelectorAll(
          "#part-two input[type=checkbox]"
        );
        checkboxes.forEach(function (checkbox) {
          if (checkbox.checked) {
            var li = document.createElement("li");
            var label = checkbox.closest("label");
            if (label) {
              li.textContent = label.textContent;
            } else {
              li.textContent =
                checkbox.nextElementSibling.nextElementSibling.textContent;
            }
            servicesList.appendChild(li);
          }
        });

        // Capture Part Three Information
        var walletsList = document.getElementById("wallets-list");
        var blockchainGroups = document.querySelectorAll(".blockchain-group");
        blockchainGroups.forEach(function (blockchainGroup) {
          var blockchain = blockchainGroup.querySelector("select").value;
          var addressCount =
            blockchainGroup.querySelector("input[type=number]").value;
          var li = document.createElement("li");
          li.textContent =
            blockchain + ": " + addressCount + " wallet addresses";
          walletsList.appendChild(li);
        });

        // Display the total quote on the engagement letter
        // Capture Part Three Information
        var totalAddressCount = 0; // Initialize a variable to hold the total address count
        var blockchainGroups = document.querySelectorAll(".blockchain-group");
        blockchainGroups.forEach(function (blockchainGroup) {
          var addressCount = parseInt(
            blockchainGroup.querySelector("input[type=number]").value
          );
          totalAddressCount += addressCount; // Accumulate the address count
        });

        var ratePerAddress = 10; // Set your rate per address here
        var totalQuote = totalAddressCount * ratePerAddress; // Calculate the total quote

        var quoteParagraph = document.getElementById("totalQuote");
        quoteParagraph.textContent = "$" + totalQuote.toFixed(2);
      }

      async function downloadPDF() {
        const { jsPDF } = window.jspdf;
        const content = document.getElementById("engagement-letter");

        // Hide the Back button
        const backButton = content.querySelector(".back-arrow");
        backButton.style.display = "none";

        // Render HTML content to a canvas
        const canvas = await html2canvas(content, {
          scale: 1, // Adjust this scale value if necessary
          useCORS: true,
        });

        // Show the Back button again
        backButton.style.display = "";

        // Get the dimensions of the canvas
        const imgWidth = canvas.width;
        const imgHeight = canvas.height;

        // Create a new PDF
        const pdf = new jsPDF({
          orientation: imgWidth > imgHeight ? "l" : "p",
          unit: "px",
          format: [imgWidth, imgHeight],
        });

        // Convert the canvas to an image data URL
        const imgData = canvas.toDataURL("image/png");

        // Add the image data to the PDF
        pdf.addImage(imgData, "PNG", 0, 0, imgWidth, imgHeight);

        // Provide a download link for the user
        pdf.save("engagement-letter.pdf");
      }

      function submitSignature() {
        var form = document.getElementById("signature-form");

        // Check if the form is valid
        if (form.checkValidity()) {
          var name = document.getElementById("signature-name").value;
          var date = document.getElementById("signature-date").value;
          alert("Engagement Letter signed by " + name + " on " + date);
          downloadPDF();
        } else {
          // If the form is invalid, display an error message
          alert("Please fill out all required fields.");
        }
      }

      function submitForm() {
        // TODO: Submit the form data to the server
        alert("Form submitted!");
      }
    </script>
  </body>
</html>
